import{a as k,V as _,b as x,c as L,d as m,e as C}from"./VTextField-1d0d3849.js";import{p as S,m as j,j as w,k as D,u as R,l as q,a as l,n as F,q as G,s as M,v as K,_ as H,r as J,o as c,d as y,w as s,c as h,g as Y,x as Q,y as W,e as r,z as p,h as f,A as X,B as Z,f as $,t as ee,C as v,D as b}from"./index-a268a96b.js";import{V as te,a as le}from"./VDataTable-6a90e37e.js";import{V as A,a as se}from"./VDialog-5a5f5472.js";const oe=S({fluid:{type:Boolean,default:!1},...j(),...w()},"VContainer"),ae=D()({name:"VContainer",props:oe(),setup(e,o){let{slots:n}=o;const{rtlClasses:d}=R();return q(()=>l(e.tag,{class:["v-container",{"v-container--fluid":e.fluid},d.value,e.class],style:e.style},n)),{}}}),V=["start","end","center"],N=["space-between","space-around","space-evenly"];function I(e,o){return M.reduce((n,d)=>{const t=e+K(d);return n[t]=o(),n},{})}const ne=[...V,"baseline","stretch"],U=e=>ne.includes(e),P=I("align",()=>({type:String,default:null,validator:U})),ie=[...V,...N],B=e=>ie.includes(e),O=I("justify",()=>({type:String,default:null,validator:B})),de=[...V,...N,"stretch"],z=e=>de.includes(e),E=I("alignContent",()=>({type:String,default:null,validator:z})),T={align:Object.keys(P),justify:Object.keys(O),alignContent:Object.keys(E)},re={align:"align",justify:"justify",alignContent:"align-content"};function ce(e,o,n){let d=re[e];if(n!=null){if(o){const t=o.replace(e,"");d+=`-${t}`}return d+=`-${n}`,d.toLowerCase()}}const ue=S({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:U},...P,justify:{type:String,default:null,validator:B},...O,alignContent:{type:String,default:null,validator:z},...E,...j(),...w()},"VRow"),me=D()({name:"VRow",props:ue(),setup(e,o){let{slots:n}=o;const d=F(()=>{const t=[];let i;for(i in T)T[i].forEach(g=>{const a=e[g],u=ce(i,g,a);u&&t.push(u)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return G(e.tag,{class:["v-row",d.value,e.class],style:e.style},(t=n.default)==null?void 0:t.call(n))}}}),he={name:"accounts",data(){return{dialog:!1,dialogDelete:!1,headers:[{text:"Seller ID",align:"start",sortable:!1,value:"ml_seller_id"},{text:"Nickname",value:"nickname"},{text:"Code",value:"code"},{text:"Access Token",value:"access_token"},{text:"Refresh Token",value:"refresh_token"},{text:"Auth Status",value:"auth_status"},{text:"Actions",value:"actions",sortable:!1}],accounts:[],editedIndex:-1,editedItem:{ml_seller_id:"",sellerid:"",access_token:"",refresh_token:""},defaultItem:{ml_seller_id:"",sellerid:"",access_token:"",refresh_token:""},loadingtable:!1,authorization_token:""}},created(){this.getAccounts()},computed:{formTitle(){return this.editedIndex===-1?"Add Account ":"Edit Account"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},methods:{getAccounts(){this.loadingtable=!0,console.log("--- auth token ---"),console.log(this.$store.state.authToken),k.get("https://sea-turtle-app-2-m3wfm.ondigitalocean.app/seller/index",{headers:{"Content-Type":"application/json;charset=UTF-8",Accept:"application/json",Authorization:this.$store.state.authToken}}).then(e=>{this.accounts=e.data,console.log(e.data),this.loadingtable=!1,console.log(e.headers)}).catch(e=>{console.log("--- erro no axios ---:"),console.log(e),e.request.status===401&&(console.log("--- user não está logado ---:"),this.$router.push("login")),this.loadingtable=!1})},save(){this.editedIndex>-1?this.editSeller():this.createSeller()},createSeller(){console.log("--- create seller() ---"),console.log("Token atual:"),console.log(this.$store.state.authToken),k.post("https://sea-turtle-app-2-m3wfm.ondigitalocean.app/seller/create",{seller:{nickname:this.editedItem.nickname,code:this.editedItem.code,ml_seller_id:this.editedItem.ml_seller_id}},{headers:{Authorization:this.$store.state.authToken}}).then(e=>{console.log(e)}).catch(e=>{console.log("Deu erro, log do erro abaixo:"),console.log(e),e.request.status===401&&(console.log("--- user não está logado ---:"),this.$router.push("login"))}).finally(()=>{this.getAccounts(),this.close()})},editSeller(){console.log("Fazendo o update do seller"),k.post("https://sea-turtle-app-2-m3wfm.ondigitalocean.app/seller/edit",{seller:{nickname:this.editedItem.nickname,code:this.editedItem.code,ml_seller_id:this.editedItem.ml_seller_id,access_token:this.editedItem.access_token,refresh_token:this.editedItem.refresh_token}},{headers:{Authorization:this.$store.state.authToken}}).then(e=>{console.log(e)}).catch(e=>{console.log(e),e.request.status===401&&(console.log("--- user não está logado ---:"),this.$router.push("login"))}).finally(()=>{this.getAccounts(),this.close()})},deleteSeller(){console.log(this.editedItem.ml_seller_id),k.post("https://sea-turtle-app-2-m3wfm.ondigitalocean.app/seller/delete",{seller:{ml_seller_id:this.editedItem.ml_seller_id}},{headers:{Authorization:this.$store.state.authToken}}).then(e=>{console.log(e)}).catch(e=>{console.log(e),e.request.status===401&&(console.log("--- user não está logado ---:"),this.$router.push("login"))}).finally(()=>{this.getAccounts(),this.closeDelete()})},close(){this.dialog=!1,this.editedItem=this.defaultItem,this.editedIndex=-1},editItem(e){this.editedIndex=this.accounts.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.accounts.indexOf(e),this.editedItem=Object.assign({},e),console.log(this.editedItem.ml_seller_id),this.dialogDelete=!0},openAddAccount(){this.dialog=!0,console.log("abrindo addAccount")},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})}}},fe={key:0,height:"400px"},ge={class:"text-h5"};function ke(e,o,n,d,t,i){const g=J("v-flex");return c(),y("div",null,[t.loadingtable==!0?(c(),y("div",fe,[l(g,null,{default:s(()=>[l(_,{class:"d-flex align-center justify-center",height:"400px"},{default:s(()=>[l(Y,{size:50,indeterminate:"",color:"primary"})]),_:1})]),_:1})])):(c(),h(_,{key:1,class:"pa-8",outlined:"",tile:""},{default:s(()=>[l(le,{headers:t.headers,items:t.accounts,"item-key":"ml_seller_id",class:"elevation-1"},{top:s(()=>[l(Q,{rounded:"",elevation:"1"},{default:s(()=>[l(W,null,{default:s(()=>[r("MercadoLivre - Contas on Seller Bot")]),_:1}),l(te,{class:"mx-4",insert:"",vertical:""}),l(p),l(A,{modelValue:t.dialog,"onUpdate:modelValue":o[6]||(o[6]=a=>t.dialog=a),"max-width":"500px"},{activator:s(({on:a,attrs:u})=>[l(f,X({color:"primary",dark:"",class:"mb-2"},u,Z(a),{onClick:i.openAddAccount}),{default:s(()=>[r(" Add Account ")]),_:2},1040,["onClick"])]),default:s(()=>[l(_,null,{default:s(()=>[l(x,null,{default:s(()=>[$("span",ge,ee(i.formTitle),1)]),_:1}),l(L,null,{default:s(()=>[l(ae,null,{default:s(()=>[l(me,null,{default:s(()=>[l(se,{cols:"12",sm:"6",md:"4"},{default:s(()=>[l(m,{modelValue:t.editedItem.nickname,"onUpdate:modelValue":o[0]||(o[0]=a=>t.editedItem.nickname=a),label:"Account Name"},null,8,["modelValue"]),t.editedIndex==-1?(c(),h(m,{key:0,modelValue:t.editedItem.ml_seller_id,"onUpdate:modelValue":o[1]||(o[1]=a=>t.editedItem.ml_seller_id=a),label:"Seller ID"},null,8,["modelValue"])):(c(),h(m,{key:1,modelValue:t.editedItem.ml_seller_id,"onUpdate:modelValue":o[2]||(o[2]=a=>t.editedItem.ml_seller_id=a),label:"Seller ID - Not editable",readonly:""},null,8,["modelValue"])),l(m,{modelValue:t.editedItem.code,"onUpdate:modelValue":o[3]||(o[3]=a=>t.editedItem.code=a),label:"Code"},null,8,["modelValue"]),t.editedIndex>-1?(c(),h(m,{key:2,modelValue:t.editedItem.access_token,"onUpdate:modelValue":o[4]||(o[4]=a=>t.editedItem.access_token=a),label:"Acess Token"},null,8,["modelValue"])):v("",!0),t.editedIndex>-1?(c(),h(m,{key:3,modelValue:t.editedItem.refresh_token,"onUpdate:modelValue":o[5]||(o[5]=a=>t.editedItem.refresh_token=a),label:"Refresh Token"},null,8,["modelValue"])):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),l(C,null,{default:s(()=>[l(p),l(f,{color:"blue darken-1",text:"",onClick:i.close},{default:s(()=>[r(" Cancel ")]),_:1},8,["onClick"]),l(f,{color:"blue darken-1",text:"",onClick:i.save},{default:s(()=>[r(" Save ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(A,{modelValue:t.dialogDelete,"onUpdate:modelValue":o[7]||(o[7]=a=>t.dialogDelete=a),"max-width":"500px"},{default:s(()=>[l(_,null,{default:s(()=>[l(x,{class:"text-h5"},{default:s(()=>[r("Are you sure you want to delete this item?")]),_:1}),l(C,null,{default:s(()=>[l(p),l(f,{color:"blue darken-1",text:"",onClick:i.closeDelete},{default:s(()=>[r("Cancel")]),_:1},8,["onClick"]),l(f,{color:"blue darken-1",text:"",onClick:i.deleteSeller},{default:s(()=>[r("OK")]),_:1},8,["onClick"]),l(p)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":s(({item:a})=>[l(b,{small:"",class:"mr-2",onClick:u=>i.editItem(a)},{default:s(()=>[r("mdi-pencil")]),_:2},1032,["onClick"]),l(b,{small:"",onClick:u=>i.deleteItem(a)},{default:s(()=>[r(" mdi-delete ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1}))])}const xe=H(he,[["render",ke]]);export{xe as default};
